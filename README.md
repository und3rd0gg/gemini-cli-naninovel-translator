# Gemini CLI Translator Tool

Мощная утилита на Python для автоматизации перевода файлов сценариев/диалогов (CSV) для игр и историй с использованием Gemini CLI. Инструмент сохраняет контекст, тон и характер персонажей, что делает его идеальным для нарративных проектов, таких как визуальные новеллы.

## Ключевые возможности

- **Интерактивный CLI:** Удобный терминальный интерфейс с навигацией стрелками, выбором файлов и меню.
- **Контекстно-зависимый перевод:** Отправляет блоки диалогов в Gemini целиком, чтобы сохранить повествовательную целостность.
- **Управление промптами:** Создавайте, редактируйте и выбирайте пользовательские шаблоны промптов (хранятся в `prompts/`).
- **Пакетная обработка:** Рекурсивный перевод отдельных файлов или целых директорий.
- **Прогресс в реальном времени:** Визуальная шкала прогресса, отслеживающая статус перевода по каждому языку.
- **Инкрементальное сохранение:** Сохраняет прогресс после каждого переведенного языка для предотвращения потери данных.
- **Кроссплатформенность:** Написан на Python, со специальной поддержкой Windows (`gemini.cmd`).

## Требования

1.  Установленный **Python 3.x**.
2.  Установленный и настроенный **Gemini CLI** (с заданным API ключом).
    - Убедитесь, что `gemini` (или `gemini.cmd` на Windows) доступен в системном PATH.

## Установка

Клонируйте репозиторий:
```bash
git clone https://github.com/und3rd0gg/gemini-cli-naninovel-translator.git
cd gemini-cli-naninovel-translator
```

## Использование

### Интерактивный режим (Рекомендуется)
Просто запустите скрипт без аргументов, чтобы открыть интерактивное меню:
```bash
python translate_scenarios.py
```
- **Навигация:** Используйте стрелки `Вверх/Вниз`.
- **Выбор:** Нажмите `Enter`.
- **Назад:** Нажмите `Esc` или стрелку `Влево`.
- **Выбор файлов:** Просматривайте папки и выбирайте конкретные `.csv` файлы или выберите `< SELECT CURRENT FOLDER >` для перевода всего содержимого директории.

### Режим командной строки (Headless)
Для автоматизации или CI/CD пайплайнов вы можете передавать аргументы напрямую:

```bash
# Перевести все файлы в папке 'scenarios' используя дефолтный промпт
python translate_scenarios.py scenarios

# Перевести конкретный файл только на английский язык
python translate_scenarios.py scenarios/chapter1.csv --lang en

# Использовать кастомный шаблон промпта с именем 'funny_style.txt' из папки prompts
python translate_scenarios.py scenarios --prompt funny_style
```

### Аргументы
- `input_path`: Путь к `.csv` файлу или директории с файлами. (По умолчанию: `scenarios`)
- `--lang`: Код целевого языка (например, `en`, `ja`). Если не указан, переводит на все языки, найденные в заголовке CSV.
- `--prompt`: Имя файла промпта в папке `prompts/` (без расширения `.txt`). (По умолчанию: `default`)

## Управление промптами
Инструмент ищет шаблоны промптов в директории `prompts/`.
- **Default:** Файл `prompts/default.txt` создается автоматически.
- **Кастомные промпты:** Создавайте новые `.txt` файлы в этой папке.
- **Плейсхолдеры:** Ваш промпт **ОБЯЗАН** содержать:
  - `{target_lang}`: Сюда будет вставлено название/код целевого языка.
  - `{text}`: Сюда будет вставлен исходный текст для перевода.

Пример `custom_prompt.txt`:
```text
Переведи этот диалог из RPG на {target_lang}. 
Используй средневековый и архаичный стиль речи.
Ввод:
{text}
```

## Формат CSV
Инструмент ожидает стандартные CSV файлы с строкой заголовка.
- **Исходная колонка:** В данный момент должна называться `ru` (Russian).
- **Целевые колонки:** Любые другие колонки (например, `en`, `jp`, `fr`) считаются целевыми языками.
- **Структура:**
  ```csv
  id, notes, ru, en, jp
  line1,,Привет,Hello,
  line2,,Пока,Bye,
  ```

## Результат
Переведенные файлы сохраняются в новой директории с суффиксом `_translated`, сохраняя исходную структуру папок.
- Вход: `scenarios/intro.csv`
- Выход: `scenarios_translated/intro.csv`